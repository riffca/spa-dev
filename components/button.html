<div class="poppy">
	<div data-text></div>

	<div>
		<div data-component="list" data-list="data-list"></div>
		<div data-component="images" data-images="1,3,4,5"></div>

		<div
			data-component="button"
			data-text="HUize"
			class="component-button">
		</div>	
	</div>
</div>

	<style>
		
		.button {
			font-size: 2rem;
		}
	</style>

	<script>
		alert(1)	
		function addEventListener(target, event, handler){
		 	target.addEventListener(event, handler)
		 	listeners.set(handler, target)
		}
		
		function bindElement(selector, extend){
			const app = {
				lib: {
					target: document.querySelector(selector),
					setAttribute(attr, val){
						this.target.setAttribute('data-'+ attr, val)
					}
				},
				...extend
			}

			if(extend.click) {
				addEventListener(app.lib.target,'click',extend.click)
			}

			const wrap = new Proxy(app, {
			  set(target, prop, value) {
			  	console.log(target, prop)
				target[prop] = value

				if(typeof value === 'object') {
					app.lib.setAttribute(prop, JSON.stringify(value))
				} else {
					app.lib.setAttribute(prop, value)

				}
				//return Reflect.set(target, prop, value, receiver)
				return true
			  }
			});
			return wrap
		}


		const componentButtonInterface = bindElement('.target',{
			loaded: false,
			companies: [],
			async loadCompanies(){
				const response = await Promise.resolve([{name: 'one', name: 'two'}])
				this.loaded = true
				this.companies = JSON.stringify(response)
			}

			click: ()=>{
				componentButtonInterface.text = "Vova"; 
				componentButtonInterface.children = [1,2,3,4,5]
				componentButtonInterface.loadCompanies()
			}
		})
	</script>
